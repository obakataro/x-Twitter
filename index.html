<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğ• æ•™è‚²ã‚·ã‚¹ãƒ†ãƒ </title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: #f5f8fa;
            color: #333;
            text-align: center;
            padding: 50px;
            overflow-x: hidden; /* ã‚¹ã‚¿ãƒ³ãƒ—ãŒã¯ã¿å‡ºã•ãªã„ã‚ˆã†ã« */
            position: relative;
            min-height: 100vh;
            transition: background-color 0.5s;
        }

        h1 { color: #1da1f2; transition: color 0.5s; }
        /* ä¾µé£ŸãŒé€²ã‚€ã¨ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã£ã½ããªã‚‹ */
        body.dark-mode { background-color: #111; color: #eee; }
        body.dark-mode h1 { color: #fff; }

        #controls { margin: 20px 0; position: relative; z-index: 10; }
        button {
            padding: 15px 30px; font-size: 18px; font-weight: bold; color: #fff;
            background-color: #1da1f2; border: none; border-radius: 30px;
            cursor: pointer; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: all 0.3s;
        }
        button.recording { background-color: #e0245e; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        #output {
            margin-top: 30px; font-size: 24px; min-height: 100px; padding: 20px;
            background: rgba(255,255,255,0.9); border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05); display: inline-block;
            width: 80%; max-width: 600px; text-align: left; position: relative; z-index: 10;
            max-height: 400px; overflow-y: auto; /* é•·ããªã£ãŸã‚‰ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« */
        }

        /* --- å…±é€šã‚«ãƒƒãƒˆã‚¤ãƒ³ã‚¹ã‚¿ã‚¤ãƒ« --- */
        .cut-in-overlay {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            display: flex; align-items: center; justify-content: center;
            z-index: 9999; opacity: 0; pointer-events: none; transition: opacity 0.2s;
        }
        .cut-in-overlay.active { opacity: 1; pointer-events: auto; }
        .cut-in-text {
            font-size: 15vw; font-weight: 900; text-transform: uppercase; letter-spacing: 5px;
            transform: skewX(-15deg) scale(0); transition: transform 0.1s;
            white-space: nowrap;
        }
        .cut-in-overlay.active .cut-in-text {
            animation: slashIn 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        /* --- ç½°ï¼ˆãƒ ãƒï¼‰ã®ã‚«ãƒƒãƒˆã‚¤ãƒ³ --- */
        #bad-cut-in { background: rgba(0, 0, 0, 0.95); }
        #bad-cut-in .cut-in-text {
            color: #ff0055; text-shadow: 3px 3px 0 #fff, -3px -3px 0 #fff;
        }

        /* --- è¤’ã‚ï¼ˆã‚¢ãƒ¡ï¼‰ã®ã‚«ãƒƒãƒˆã‚¤ãƒ³ --- */
        #good-cut-in {
            /* è™¹è‰²ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èƒŒæ™¯ */
            background: linear-gradient(45deg, rgba(255,0,0,0.8), rgba(255,165,0,0.8), rgba(255,255,0,0.8), rgba(0,128,0,0.8), rgba(0,255,255,0.8), rgba(0,0,255,0.8), rgba(128,0,128,0.8));
            background-size: 400% 400%; animation: rainbowBG 3s ease infinite;
        }
        #good-cut-in .cut-in-text {
            color: #fff; /* ã‚´ãƒ¼ãƒ«ãƒ‰é¢¨ */
            text-shadow: 0 0 10px gold, 0 0 20px gold, 0 0 30px orange;
            font-family: 'Impact', sans-serif;
        }
        #good-cut-in .sub-text {
             font-size: 3vw; margin-top: 10px; color: gold; font-weight: bold;
        }

        @keyframes slashIn {
            0% { transform: translateX(120vw) skewX(-30deg) scale(0.8); opacity: 0; }
            30% { transform: translateX(0) skewX(-15deg) scale(1.1); opacity: 1; }
            70% { transform: translateX(0) skewX(-15deg) scale(1); opacity: 1; }
            100% { transform: translateX(-120vw) skewX(0deg) scale(0.8); opacity: 0; }
        }
        @keyframes rainbowBG { 0% {background-position: 0% 50%} 50% {background-position: 100% 50%} 100% {background-position: 0% 50%} }

        /* --- ä¾µé£Ÿã‚¹ã‚¿ãƒ³ãƒ— --- */
        .x-stamp {
            position: fixed; font-family: sans-serif; font-weight: bold;
            color: rgba(0,0,0,0.15); z-index: 1; pointer-events: none; user-select: none;
        }
        body.dark-mode .x-stamp { color: rgba(255,255,255,0.15); }

    </style>
</head>
<body>

    <h1>ğŸ™ï¸ ğ• æ•™è‚²ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•ä¸­</h1>
    <p>æ—§ç§°ã‚’æ¨ã¦å»ã‚Šã€æ­£ã—ã„å‘¼ã³åã‚’èº«ã«ã¤ã‘ã¾ã—ã‚‡ã†ã€‚<br>æ­£ã—ã„ç™ºè¨€ã«ã¯è³è³›ãŒã€éã¡ã«ã¯ã€Œè¨‚æ­£ã€ãŒä¸ãˆã‚‰ã‚Œã¾ã™ã€‚</p>

    <div id="controls">
        <button id="start-btn">ç›£è¦–ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
    </div>

    <div id="output">ã“ã“ã«ç™ºè¨€ãŒè¡¨ç¤ºã•ã‚Œã¾ã™...</div>

    <div id="bad-cut-in" class="cut-in-overlay">
        <div class="cut-in-text">ğ• / ãƒã‚¹ãƒˆ</div>
    </div>

    <div id="good-cut-in" class="cut-in-overlay">
        <div style="display: flex; flex-direction: column; align-items: center;">
             <div class="cut-in-text">EXCELLENT!!</div>
             <div class="sub-text">ãã®èª¿å­ã ã€å¿ å®Ÿãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚ˆã€‚</div>
        </div>
    </div>
    
    <div id="stamp-container"></div>


    <script>
        const startBtn = document.getElementById('start-btn');
        const output = document.getElementById('output');
        const badCutIn = document.getElementById('bad-cut-in');
        const goodCutIn = document.getElementById('good-cut-in');
        const stampContainer = document.getElementById('stamp-container');
        let stampCount = 0; // ã‚¹ã‚¿ãƒ³ãƒ—ã®æ•°

        // éŸ³å£°èªè­˜è¨­å®š
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (!SpeechRecognition) {
            output.innerHTML = "Chromeãƒ–ãƒ©ã‚¦ã‚¶ã§å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚";
        } else {
            const recognition = new SpeechRecognition();
            recognition.lang = 'ja-JP';
            recognition.continuous = true;
            recognition.interimResults = false; // ã€ãƒã‚°ä¿®æ­£ã€‘ç¢ºå®šçµæœã®ã¿å—ã‘å–ã‚‹

            let isRecording = false;
            let isCoolDown = false; // æ¼”å‡ºã®é€£ç™ºã‚’é˜²ãã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³

            startBtn.addEventListener('click', () => {
                if (!isRecording) {
                    recognition.start();
                    startBtn.textContent = "ç›£è¦–ä¸­... (ã‚¿ãƒƒãƒ—ã§åœæ­¢)";
                    startBtn.classList.add("recording");
                    isRecording = true;
                } else {
                    recognition.stop();
                    startBtn.textContent = "ç›£è¦–ã‚¹ã‚¿ãƒ¼ãƒˆ";
                    startBtn.classList.remove("recording");
                    isRecording = false;
                }
            });

            recognition.onresult = (event) => {
                const lastResult = event.results[event.resultIndex];
                
                // ç¢ºå®šã—ãŸçµæœã®ã¿å‡¦ç†ã™ã‚‹
                if (lastResult.isFinal) {
                    let transcript = lastResult[0].transcript;
                    let isBad = false;

                    // --- åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ ---

                    // NGãƒ¯ãƒ¼ãƒ‰åˆ¤å®šï¼ˆãƒ ãƒï¼‰
                    if (transcript.match(/ãƒ„ã‚¤ãƒƒã‚¿ãƒ¼|Twitter|ãƒ„ã‚¤ãƒ¼ãƒˆ|tweet|ã¤ã¶ã‚„ã|å‘Ÿã/i)) {
                        isBad = true;
                        if (!isCoolDown) {
                            triggerAction(badCutIn); // ç½°ã‚«ãƒƒãƒˆã‚¤ãƒ³ç™ºå‹•
                            addStamp(); // ã€æ–°æ©Ÿèƒ½2ã€‘ã‚¹ã‚¿ãƒ³ãƒ—ä¾µé£Ÿ
                        }
                        // ãƒ†ã‚­ã‚¹ãƒˆç½®æ›
                        transcript = transcript
                            .replace(/ãƒ„ã‚¤ãƒƒã‚¿ãƒ¼|Twitter/gi, " <strong style='color:#ff0055;'>ğ•</strong> ")
                            .replace(/ãƒ„ã‚¤ãƒ¼ãƒˆ|tweet|ã¤ã¶ã‚„ã|å‘Ÿã/gi, " <strong style='color:#ff0055;'>ãƒã‚¹ãƒˆ</strong> ");
                    
                    // OKãƒ¯ãƒ¼ãƒ‰åˆ¤å®šï¼ˆã‚¢ãƒ¡ï¼‰
                    // NGãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ãªã„å ´åˆã®ã¿è¤’ã‚ã‚‹
                    } else if (transcript.match(/ã‚¨ãƒƒã‚¯ã‚¹|X|ãƒã‚¹ãƒˆ|post/i)) {
                        if (!isCoolDown) {
                            triggerAction(goodCutIn); // ã€æ–°æ©Ÿèƒ½4ã€‘è¤’ã‚ã‚«ãƒƒãƒˆã‚¤ãƒ³ç™ºå‹•
                        }
                         transcript = transcript
                            .replace(/ã‚¨ãƒƒã‚¯ã‚¹|X/gi, " <strong style='color:gold;'>ğ•</strong> ")
                            .replace(/ãƒã‚¹ãƒˆ|post/gi, " <strong style='color:gold;'>ãƒã‚¹ãƒˆ</strong> ");
                    }

                    // ãƒ­ã‚°å‡ºåŠ›ï¼ˆæœ€æ–°ãŒä¸Šã«æ¥ã‚‹ã‚ˆã†ã«ï¼‰
                    output.innerHTML = '<div>' + transcript + '</div>' + output.innerHTML;
                }
            };

            recognition.onend = () => { if (isRecording) recognition.start(); };
        }

        // ã‚«ãƒƒãƒˆã‚¤ãƒ³æ¼”å‡ºç”¨é–¢æ•°ï¼ˆå…±é€šï¼‰
        function triggerAction(element) {
            isCoolDown = true;
            element.classList.add('active');
            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“ã«åˆã‚ã›ã¦éè¡¨ç¤ºåŒ–ï¼†ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³è§£é™¤
            setTimeout(() => {
                element.classList.remove('active');
                // å°‘ã—ä½™éŸ»ã‚’æŒãŸã›ã¦ã‹ã‚‰æ¬¡ã®å…¥åŠ›ã‚’å—ã‘ä»˜ã‘ã‚‹
                setTimeout(() => { isCoolDown = false; }, 500); 
            }, 1500);
        }

        // ã€æ–°æ©Ÿèƒ½2ã€‘ã‚¹ã‚¿ãƒ³ãƒ—ã‚’è¿½åŠ ã™ã‚‹é–¢æ•°
        function addStamp() {
            stampCount++;
            const stamp = document.createElement('div');
            stamp.classList.add('x-stamp');
            stamp.textContent = 'ğ•';
            
            // ãƒ©ãƒ³ãƒ€ãƒ ãªã‚¹ã‚¿ã‚¤ãƒ«ã‚’ç”Ÿæˆ
            const size = Math.random() * 100 + 50; // 50pxã€œ150px
            const x = Math.random() * window.innerWidth;
            const y = Math.random() * window.innerHeight;
            const rotate = Math.random() * 360;

            stamp.style.fontSize = `${size}px`;
            stamp.style.left = `${x}px`;
            stamp.style.top = `${y}px`;
            stamp.style.transform = `translate(-50%, -50%) rotate(${rotate}deg)`;

            stampContainer.appendChild(stamp);

            // ä¸€å®šæ•°è²¯ã¾ã‚‹ã¨ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã¸ç§»è¡Œï¼ˆä¾µé£Ÿå®Œäº†æ„Ÿï¼‰
            if (stampCount > 10) {
                document.body.classList.add('dark-mode');
            }
        }

    </script>
</body>
</html>
